Zoom: per implementarlo, dovrei trasformare molte #define in variabili globali.